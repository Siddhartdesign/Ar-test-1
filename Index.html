<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover" />
  <title>MindAR — simple overlay demo</title>

  <!-- A-Frame & MindAR (CDN) -->
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.1.4/dist/mindar-image-aframe.prod.js"></script>

  <style>
    body { margin:0; overflow:hidden; background:#000; }
    #loading { position: absolute; left:0; right:0; top:10px; text-align:center; color:#fff; z-index:3; font-family:system-ui; }
    .fade { transition: opacity 600ms ease; opacity: 0; }
    .visible { opacity: 1; }
  </style>
</head>
<body>
  <div id="loading">Point your camera at the image — allow camera access</div>

  <a-scene mindar-image="imageTargetSrc: assets/targets.mind; uiElement: #loading;" embedded color-space="sRGB">
    <a-assets>
      <img id="overlayImg" src="assets/overlay.gif" crossorigin="anonymous" />
    </a-assets>

    <!-- targetIndex: 0 -> first target in targets.mind -->
    <a-entity mindar-image-target="targetIndex: 0">
      <!-- plane sized 1x1, centered — adjust later -->
      <a-plane id="overlayPlane" position="0 0 0" rotation="-90 0 0" width="1" height="1" material="shader: flat; src: #overlayImg" visible="false" class="fade"></a-plane>
    </a-entity>

    <a-entity camera></a-entity>
  </a-scene>

  <script>
    // Wait for scene to be ready
    window.addEventListener('load', () => {
      const targetEntity = document.querySelector('[mindar-image-target]');
      const overlay = document.querySelector('#overlayPlane');

      // When MindAR detects the target
      targetEntity.addEventListener('targetFound', () => {
        overlay.setAttribute('visible', 'true');
        overlay.classList.add('visible');
      });

      // When the target is lost
      targetEntity.addEventListener('targetLost', () => {
        overlay.classList.remove('visible');
        // keep visible=false until fade finishes
        setTimeout(()=> overlay.setAttribute('visible','false'), 700);
      });
    });
  </script>
</body>
</html>
